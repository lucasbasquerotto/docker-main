params:

- name: "main/log/efk/vars.env"
  params:
    env_files: {{ params.env_files | default([]) | to_json }}

- name: "main/log/efk/vars.main"
  params:
    volumes:
      data_dir: "{{ params_aux.data_dir }}"
    fluentd:
      elasticsearch_port: "{{ params.elasticsearch.port | default('9200') }}"
      flush_interval: "{{ params.fluentd.flush_interval | default('1s') }}"

- name: "main/log/efk/vars.compose"
  params: 
    compose:
      fluentd:
        networks: {{ params.fluentd.networks | default([]) | to_json }}
        environments: {{ params.fluentd.environments | default([]) | to_json }}
        ports: {{ params.fluentd.ports | default([]) | to_json }}
      elasticsearch:
        networks: {{ params.elasticsearch.networks | default([]) | to_json }}
        environments: {{ params.elasticsearch.environments | default([]) | to_json }}
        ports: {{ params.elasticsearch.ports | default([]) | to_json }}
      kibana:
        networks: {{ params.kibana.networks | default([]) | to_json }}
        environments: {{ params.kibana.environments | default([]) | to_json }}
        ports: {{ params.kibana.ports | default([]) | to_json }}
    env:  
      ctx_name: "{{ params_aux.pod_id }}"
      pod_repo: "{{ params_aux.pod.repo }}"
      pod_repo_version: "{{ params_aux.pod.repo_version }}"
      git_commit: "{{ params_aux.git_commit }}"
      pod_env_dir: "{{ params_aux.pod_env_dir }}"
      data_dir: "{{ params_aux.data_dir }}"
      fluentd_image: "{{ params.fluentd.image }}"
      fluentd_version: "{{ params.fluentd.version }}"
      elasticsearch_image: "{{ params.elasticsearch.image }}"
      elasticsearch_version: "{{ params.elasticsearch.version }}"
      kibana_image: "{{ params.kibana.image }}"
      kibana_version: "{{ params.kibana.version }}"